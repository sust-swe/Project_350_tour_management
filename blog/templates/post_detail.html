{% extends 'base2.html' %}
{% load staticfiles %}
{% load hitcount_tags %}
{% block content_1 %}


<div class="container">
    <div class="row">
        <div class=" justify-content-center col-md-12 card mb-4  mt-3 left  top">
            <div class="card-body">
                <!-- {{post_detail}} -->
                <h1>{% block title %} {{ post.title }} {% endblock title %}</h1>
                <!-- <p>{{ post.get_hit_count }}</p> -->
                <p class=" text-muted">{{ post.user_detail.user }} | {{ post.created_on }}</p>
                <i class="far fa-eye"></i> {% get_hit_count for post %} <b> </b>
                <p class="card-text ">{{ post.content | safe | linebreaksbr}}</p>
                {% if user.is_authenticated %}
                <a href="{% url 'post_edit' pk=post.pk %}">
                    <i class="far fa-edit"></i></span>
                </a> &nbsp;
                <!-- <a class='btn btn-primary' href="{% url 'post_remove' pk=post.pk %}" onclick="successful();"
                    style="background-color: rgb(238, 10, 10);">
                    <span class="glyphicon glyphicon-remove">Remove</span>
                </a> -->
                <button class="btn btn-danger" type="button" onclick="successfulz();" <i
                    class="far fa-trash-alt"></i></button>



                <script type="text/javascript">
                    function successfulz() {
                        swal({
                            title: "Are you sure?",
                            text: "Once deleted, you will not be able to recover this Post!",
                            icon: "warning",
                            buttons: true,
                            dangerMode: true,
                        })
                            .then((willDelete) => {
                                if (willDelete) {
                                    window.location.href = "{% url 'post_remove' pk=post.pk %}";
                                    // <a href="{% url 'post_remove' pk=post.pk %}" />
                                    swal("Poof! Your Post has been deleted!", {
                                        icon: "success",
                                    });
                                } else {
                                    swal("Post is not Deleted!");
                                }
                            });
                    }


                </script>
                <br>
                {% endif %}
                <br>
                <!-- <a href="{% url 'post_remove' pk=post.pk %}" /> -->

                <a href="#" onClick="document.getElementById('likebutton').submit()"><i class="far fa-thumbs-up">
                    </i></a>
                {{post.likes}} &nbsp; <a href="#" onClick="document.getElementById('dislikebutton').submit()"><i
                        class="far fa-thumbs-down"></i></a>
                {{post.dislikes}}


                <form id="likebutton" method="POST" action="/blog/bloglist/{{post.id}}/preference/1/">
                    {% csrf_token %}
                    <input type="hidden">
                </form>

                <form id="dislikebutton" method="POST" action="/blog/bloglist/{{post.id}}/preference/2/">
                    {% csrf_token %}
                    <input type="hidden">
                </form>
                <h1>Comments: </h1>
                <a class="btn btn-primary" href="{% url 'addcomment' pk=post.pk %}">Add Comment</a>

                </form>


            </div>
            {% for comment in post.comments.all %}
            <br>
            {% if user.is_authenticated or comment.approve_comment %}
            {{ comment.text | safe }}
            {{comment.user_detail.user}} |
            {{comment.created_on}}
            <!-- <a class="btn btn-primary" href="{% url 'comment_remove' pk=comment.pk %}">Remove Comment</a> -->

            {% if not comment.approve_comment %}
            <a href="{% url 'comment_approve' pk=comment.pk %}" <i class="far fa-check-circle"></i>Approve</a>
            <a href="{% url 'comment_remove' pk=comment.pk %}" <i class="far fa-times-circle"></i>Remove</a>
            {% endif %}
            <br>



            {% endif %}
            {% empty %}
            <p>No Comments!</p>
            {% endfor %}

        </div>
    </div>
</div>

{% endblock content_1 %}